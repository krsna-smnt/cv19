{% extends 'base.html' %}

{% block content %}

<div class="container-fluid">

	<div id="chartdiv" style="width: 800; height: 800px;"></div>

</div>

<script>

	var map = am4core.create("chartdiv", am4maps.MapChart);
	map.zoomControl = new am4maps.ZoomControl();
	map.zoomControl.slider.height = 200;
	map.panBehavior = "rotateLongLat";
	map.geodata = am4geodata_worldIndiaHigh;
	map.projection = new am4maps.projections.Orthographic();

	var worldSeries = map.series.push(new am4maps.MapPolygonSeries());
	worldSeries.useGeodata = true;

	var indiaSeries = map.series.push(new am4maps.MapPolygonSeries());
	indiaSeries.geodata = am4geodata_india2019High;

	var lst = [];
	{% for country in countries %}

		var display = "<table class='table table-responsive table-bordered'><thead><tr><th>Country</th><th>Infected</th><th>Dead</th><th>Recovered</th></tr></thead><tbody><tr><td>{{ country.name }}</td><td>{{ country.total_cases }}</td><td>{{ country.dead }}</td><td>{{ country.cured }}</td></tr></tbody></table>"
		lst.push({"id": "{{ country.code }}", "tooltipHTML": display, "fill": am4core.color("{{ country.infected_color }}")});

	{% endfor %}

	worldSeries.data = lst;

	map.series.push(worldSeries);

	var worldTemplate = worldSeries.mapPolygons.template;
	// worldTemplate.tooltipText = "{name}\n10 Dead\n99 Fucked";
	worldTemplate.fill = am4core.color("#bbbbbb");
	worldTemplate.propertyFields.tooltipHTML = "tooltipHTML"
	worldTemplate.propertyFields.fill = "fill";

	var indiaTemplate = indiaSeries.mapPolygons.template;
	indiaTemplate.tooltipText = "{name}";

	var hs = worldTemplate.states.create("hover");
	hs.properties.fill = am4core.color("#770000");

	var ihs = indiaTemplate.states.create("hover");
	ihs.properties.fill = am4core.color("#ff9933");


</script>

{% endblock %}